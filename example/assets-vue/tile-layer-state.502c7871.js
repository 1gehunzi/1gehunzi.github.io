import{_ as e,m as a,S as l,u as t,aI as i,r as s,o as n,c as o,a as c,f as d,z as r,q as h,i as u,h as m,bt as p,t as y,F as g,p as f,l as k}from"./common.10acb102.js";const v=e=>(f("data-v-00eebe4a"),e=e(),k(),e),b={class:"f-mb"},x={key:1,class:"property-content"},T={class:"f-mb f-mt title"},w={class:"bottomBox"},_={class:"f-mb"},L=v((()=>c("span",{class:"mars-pannel-item-label"},"状态:",-1))),C={class:"f-mb"},I={key:0,class:"f-mb"},P=v((()=>c("span",{class:"mars-pannel-item-label"},"图层交互:",-1)));var W=e(a({__name:"tile-layer-state",props:{interaction:{type:Boolean,default:!1}},setup(e){const a=e,f=window.mapWork,k=f.mars3d,v=l({show:!0,hasAddTileLayer:!0,hasPopup:!0,hasHighlight:!0,showTable:!0,layerName:""}),W=t([]),B=t([]),S=t([{title:"名称",dataIndex:"name",key:"name",align:"center"},{title:"编辑",dataIndex:"edit",key:"edit",align:"center"}]),H=t({hideSelectAll:!0,hideDefaultSelections:!0,selectedRowKeys:B,onChange:e=>{B.value=e},onSelect:(e,a)=>{A.getLayerById(e.key).show=a}}),N=e=>({onClick:()=>{j(e)}});let A,U;function $(){setTimeout((()=>{1===W.value.length&&j(W.value[0])}),50)}i((()=>{A=f.map,v.hasAddTileLayer=Boolean(f.addTileLayer);const e=[],a=A.getLayers();for(let l=a.length-1;l>=0;l--){const t=a[l];t.isPrivate||e.push({key:t.id,name:`${t.type} - ${t.name||"未命名"}`,isTile:t.isTile})}W.value=e,console.log("当前图层列表为",e),B.value=e.map((e=>e.key)),$(),A.on(k.EventType.addLayer,(function(e){const a=e.layer;a.isPrivate||"POI查询"===a.name||(W.value.push({key:a.id,name:`${a.type} - ${a.name||"未命名"}`,isTile:a.isTile}),B.value=W.value.map((e=>e.key)),$())})),A.on(k.EventType.removeLayer,(function(e){const a=e.layer.id,l=W.value.findIndex((e=>e.key===a));W.value.splice(l,1),U&&U.id===a&&(U=null,v.layerName="")}))}));const z=[{type:"slider",field:"opacity",label:"透明度",step:.01,min:0,max:1,value:1,extra:"{opacity}",extraWidth:40,change(e){E("opacity",e)}},{type:"slider",field:"brightness",label:"亮度",step:.01,min:0,max:3,value:1,extra:"{brightness}",extraWidth:40,change(e){E("brightness",e)}},{type:"slider",field:"contrast",label:"对比度",step:.01,min:0,max:3,value:1.16,extra:"{contrast}",extraWidth:40,change(e){E("contrast",e)}},{type:"slider",field:"hue",label:"色彩",step:.01,min:0,max:3,value:.1,extra:"{hue}",extraWidth:40,change(e){E("hue",e)}},{type:"slider",field:"saturation",label:"饱和度",step:.01,min:0,max:3,value:1,extra:"{saturation}",extraWidth:40,change(e){E("saturation",e)}},{type:"slider",field:"gamma",label:"伽马值",step:.01,min:0,max:3,value:.53,extra:"{gamma}",extraWidth:40,change(e){E("gamma",e)}}],E=(e,a)=>{U&&(U[e]=a)},O=()=>{f.addTileLayer()},R=()=>{f.removeTileLayer()},j=e=>{e.isTile&&(v.layerName=e.name,U=A.getLayerById(e.key),v.show=U.show)},q=()=>{U&&(U.show=v.show)},D=()=>{U&&(v.hasPopup?U.bindPopup("all"):U.unbindPopup())},F=()=>{U&&(v.hasHighlight?U.bindHighlight({clampToGround:!0,fill:!0,color:"#2deaf7",opacity:.6,outline:!0,outlineWidth:3,outlineColor:"#e000d9",outlineOpacity:1}):U.unbindHighlight())};return(e,l)=>{const t=s("mars-button"),i=s("a-checkbox"),f=s("a-space"),k=s("mars-icon"),B=s("mars-table"),U=s("mars-gui");return n(),o(g,null,[c("div",b,[d(f,null,{default:r((()=>[v.hasAddTileLayer?(n(),h(t,{key:0,onClick:O},{default:r((()=>[u("添加图层")])),_:1})):m("",!0),v.hasAddTileLayer?(n(),h(t,{key:1,onClick:R},{default:r((()=>[u("移除图层")])),_:1})):m("",!0),d(i,{checked:v.showTable,"onUpdate:checked":l[0]||(l[0]=e=>v.showTable=e),title:"显示图层内所有矢量数据列表"},{default:r((()=>[u("显示列表")])),_:1},8,["checked"])])),_:1})]),v.showTable?(n(),h(B,{key:0,"row-selection":H.value,dataSource:W.value,columns:S.value,bordered:"",pagination:{pageSize:5},size:"small",customRow:N},{bodyCell:r((({column:e,record:a})=>["edit"===e.dataIndex?(n(),h(f,{key:0},{default:r((()=>[d(k,{icon:"aiming",color:"#f2f2f2",class:"icon-vertical-a",title:"飞行定位",onClick:p((e=>(e=>{const a=A.getLayerById(e.key);a&&a.flyTo()})(a)),["stop"])},null,8,["onClick"]),d(k,{icon:"delete",color:"#f2f2f2",class:"icon-vertical-a",title:"删除图层",onClick:p((e=>(e=>{const a=A.getLayerById(e.key);a&&(a.remove(!0),v.layerName="")})(a)),["stop"])},null,8,["onClick"])])),_:2},1024)):m("",!0)])),_:1},8,["row-selection","dataSource","columns"])):m("",!0),v.showTable&&v.layerName?(n(),o("div",x,[c("h2",T,y(v.layerName),1),c("div",w,[c("div",_,[d(f,null,{default:r((()=>[L,d(i,{checked:v.show,"onUpdate:checked":l[1]||(l[1]=e=>v.show=e),onChange:q,title:"显示隐藏状态"},{default:r((()=>[u("显示")])),_:1},8,["checked"])])),_:1})]),c("div",C,[d(U,{options:z})]),a.interaction?(n(),o("div",I,[d(f,null,{default:r((()=>[P,d(i,{checked:v.hasPopup,"onUpdate:checked":l[2]||(l[2]=e=>v.hasPopup=e),onChange:D,title:"是否绑定Popup鼠标单击弹窗"},{default:r((()=>[u("单击Popup")])),_:1},8,["checked"]),d(i,{checked:v.hasHighlight,"onUpdate:checked":l[3]||(l[3]=e=>v.hasHighlight=e),onChange:F,title:"是否绑定单击高亮其对应矢量数据"},{default:r((()=>[u("单击高亮")])),_:1},8,["checked"])])),_:1})])):m("",!0)])])):m("",!0)],64)}}}),[["__scopeId","data-v-00eebe4a"]]);export{W as T};

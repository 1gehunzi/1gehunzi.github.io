import{_ as e}from"./read.03cd8dda.js";import{d,s as a,aH as t,o as n,Y as l,b2 as s,a5 as o,_ as c,I as i}from"./common.5a7f0626.js";var r=e(d({__name:"index",setup(e){const d=window.mapWork,r=a([]),u=a([]),h=a([]),p={},y=a(!1),v=a(!1);let k,m={};d.eventTarget.on("loadTypeList",(function(e){m=e.modelData,function(){const e=m;for(let a=e.length-1;a>=0;a--){const t=d.createLayer(d.createLayer(e[a]));if(t&&20===t.pid){const d={title:t.name,key:t.id,id:t.id,pId:t.pid};d.children=g(d,e),r.value.push(d),u.value.push(d.key)}}}()}));const f=(e,a)=>{const t=a.node,n=p[t.key],l=t.children;console.log("node",t),n&&!n.show&&(n.show=!0),0!==l.length||t.checked||(d.addLayer(n),"合肥市区"===t.title&&(k=n,v.value=!0,!0===y.value&&d.cutModel(n)),"合肥天鹅湖"!==t.title||t.checked||(y.value=!0,!0===v.value&&d.cutModel(k))),a.node.children&&a.node.children.length&&w(e,a.node.children),0===l.length&&t.checked&&(n.show=!1,"合肥天鹅湖"===t.title&&(y.value=!1),"合肥市区"===t.title&&(v.value=!1))};function w(e,a){a.forEach((a=>{const t=p[a.key];t&&(t.isAdded||d.addLayer(t),-1!==e.indexOf(a.key)?t.show=!0:t.show=!1,a.children&&w(e,a.children))}))}function g(e,a){return a.filter((d=>d.pid===e.id)).map((e=>{const t={title:e.name,key:e.id,id:e.id,pId:e.pid},n=d.createLayer(e);return p[e.id]=n,t.children=g(t,a),u.value.push(t.key),e.isAdded&&e.show&&h.value.push(t.key),t}))}return(e,d)=>{const a=t("mars-tree"),p=t("mars-dialog");return n(),l(p,{visible:!0,right:"10",top:"10",width:"240",customClass:"layer-tree"},{default:s((()=>[o(a,{checkable:"","tree-data":r.value,expandedKeys:u.value,"onUpdate:expandedKeys":d[0]||(d[0]=e=>u.value=e),checkedKeys:h.value,"onUpdate:checkedKeys":d[1]||(d[1]=e=>h.value=e),onCheck:f},{title:s((({title:e})=>[c("span",null,i(e),1)])),_:1},8,["tree-data","expandedKeys","checkedKeys"])])),_:1})}}}),[["__scopeId","data-v-0d5dc467"]]);export{r as default};

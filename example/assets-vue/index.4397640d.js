import{_ as e,m as a,u as d,r as t,o as n,q as l,z as s,f as o,a as c,t as i}from"./common.10acb102.js";var r=e(a({__name:"index",setup(e){const a=window.mapWork,r=d([]),u=d([]),h=d([]),p={},y=d(!1),v=d(!1);let k,m={};a.eventTarget.on("loadTypeList",(function(e){m=e.modelData,function(){const e=m;for(let d=e.length-1;d>=0;d--){const t=a.createLayer(a.createLayer(e[d]));if(t&&20===t.pid){const a={title:t.name,key:t.id,id:t.id,pId:t.pid};a.children=g(a,e),r.value.push(a),u.value.push(a.key)}}}()}));const f=(e,d)=>{const t=d.node,n=p[t.key],l=t.children;console.log("node",t),n&&!n.show&&(n.show=!0),0!==l.length||t.checked||(a.addLayer(n),"合肥市区"===t.title&&(k=n,v.value=!0,!0===y.value&&a.cutModel(n)),"合肥天鹅湖"!==t.title||t.checked||(y.value=!0,!0===v.value&&a.cutModel(k))),d.node.children&&d.node.children.length&&w(e,d.node.children),0===l.length&&t.checked&&(n.show=!1,"合肥天鹅湖"===t.title&&(y.value=!1),"合肥市区"===t.title&&(v.value=!1))};function w(e,d){d.forEach((d=>{const t=p[d.key];t&&(t.isAdded||a.addLayer(t),-1!==e.indexOf(d.key)?t.show=!0:t.show=!1,d.children&&w(e,d.children))}))}function g(e,d){return d.filter((a=>a.pid===e.id)).map((e=>{const t={title:e.name,key:e.id,id:e.id,pId:e.pid},n=a.createLayer(e);return p[e.id]=n,t.children=g(t,d),u.value.push(t.key),e.isAdded&&e.show&&h.value.push(t.key),t}))}return(e,a)=>{const d=t("mars-tree"),p=t("mars-dialog");return n(),l(p,{visible:!0,right:"10",top:"10",width:"240",customClass:"layer-tree"},{default:s((()=>[o(d,{checkable:"","tree-data":r.value,expandedKeys:u.value,"onUpdate:expandedKeys":a[0]||(a[0]=e=>u.value=e),checkedKeys:h.value,"onUpdate:checkedKeys":a[1]||(a[1]=e=>h.value=e),onCheck:f},{title:s((({title:e})=>[c("span",null,i(e),1)])),_:1},8,["tree-data","expandedKeys","checkedKeys"])])),_:1})}}}),[["__scopeId","data-v-0d5dc467"]]);export{r as default};

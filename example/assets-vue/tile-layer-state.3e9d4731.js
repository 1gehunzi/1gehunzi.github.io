import{d as e,r as a,s as l,au as t,aH as i,o as s,c as o,_ as n,a5 as d,b2 as c,Y as r,a4 as h,Z as u,bp as m,I as p,M as y,aC as g,aA as f}from"./common.5a7f0626.js";import{_ as k}from"./read.03cd8dda.js";const v=e=>(g("data-v-00eebe4a"),e=e(),f(),e),b={class:"f-mb"},x={key:1,class:"property-content"},T={class:"f-mb f-mt title"},w={class:"bottomBox"},_={class:"f-mb"},C=v((()=>n("span",{class:"mars-pannel-item-label"},"状态:",-1))),L={class:"f-mb"},I={key:0,class:"f-mb"},P=v((()=>n("span",{class:"mars-pannel-item-label"},"图层交互:",-1)));var W=k(e({__name:"tile-layer-state",props:{interaction:{type:Boolean,default:!1}},setup(e){const g=e,f=window.mapWork,k=f.mars3d,v=a({show:!0,hasAddTileLayer:!0,hasPopup:!0,hasHighlight:!0,showTable:!0,layerName:""}),W=l([]),B=l([]),H=l([{title:"名称",dataIndex:"name",key:"name",align:"center"},{title:"编辑",dataIndex:"edit",key:"edit",align:"center"}]),A=l({hideSelectAll:!0,hideDefaultSelections:!0,selectedRowKeys:B,onChange:e=>{B.value=e},onSelect:(e,a)=>{S.getLayerById(e.key).show=a}}),N=e=>({onClick:()=>{R(e)}});let S,U;function $(){setTimeout((()=>{1===W.value.length&&R(W.value[0])}),50)}t((()=>{S=f.map,v.hasAddTileLayer=Boolean(f.addTileLayer);const e=[],a=S.getLayers();for(let l=a.length-1;l>=0;l--){const t=a[l];t.isPrivate||e.push({key:t.id,name:`${t.type} - ${t.name||"未命名"}`,isTile:t.isTile})}W.value=e,console.log("当前图层列表为",e),B.value=e.map((e=>e.key)),$(),S.on(k.EventType.addLayer,(function(e){const a=e.layer;a.isPrivate||"POI查询"===a.name||(W.value.push({key:a.id,name:`${a.type} - ${a.name||"未命名"}`,isTile:a.isTile}),B.value=W.value.map((e=>e.key)),$())})),S.on(k.EventType.removeLayer,(function(e){const a=e.layer.id,l=W.value.findIndex((e=>e.key===a));W.value.splice(l,1),U&&U.id===a&&(U=null,v.layerName="")}))}));const j=[{type:"slider",field:"opacity",label:"透明度",step:.01,min:0,max:1,value:1,extra:"{opacity}",extraWidth:40,change(e){z("opacity",e)}},{type:"slider",field:"brightness",label:"亮度",step:.01,min:0,max:3,value:1,extra:"{brightness}",extraWidth:40,change(e){z("brightness",e)}},{type:"slider",field:"contrast",label:"对比度",step:.01,min:0,max:3,value:1.16,extra:"{contrast}",extraWidth:40,change(e){z("contrast",e)}},{type:"slider",field:"hue",label:"色彩",step:.01,min:0,max:3,value:.1,extra:"{hue}",extraWidth:40,change(e){z("hue",e)}},{type:"slider",field:"saturation",label:"饱和度",step:.01,min:0,max:3,value:1,extra:"{saturation}",extraWidth:40,change(e){z("saturation",e)}},{type:"slider",field:"gamma",label:"伽马值",step:.01,min:0,max:3,value:.53,extra:"{gamma}",extraWidth:40,change(e){z("gamma",e)}}],z=(e,a)=>{U&&(U[e]=a)},E=()=>{f.addTileLayer()},O=()=>{f.removeTileLayer()},R=e=>{e.isTile&&(v.layerName=e.name,U=S.getLayerById(e.key),v.show=U.show)},D=()=>{U&&(U.show=v.show)},G=()=>{U&&(v.hasPopup?U.bindPopup("all"):U.unbindPopup())},K=()=>{U&&(v.hasHighlight?U.bindHighlight({clampToGround:!0,fill:!0,color:"#2deaf7",opacity:.6,outline:!0,outlineWidth:3,outlineColor:"#e000d9",outlineOpacity:1}):U.unbindHighlight())};return(e,a)=>{const l=i("mars-button"),t=i("a-checkbox"),f=i("a-space"),k=i("mars-icon"),B=i("mars-table"),U=i("mars-gui");return s(),o(y,null,[n("div",b,[d(f,null,{default:c((()=>[v.hasAddTileLayer?(s(),r(l,{key:0,onClick:E},{default:c((()=>[h("添加图层")])),_:1})):u("",!0),v.hasAddTileLayer?(s(),r(l,{key:1,onClick:O},{default:c((()=>[h("移除图层")])),_:1})):u("",!0),d(t,{checked:v.showTable,"onUpdate:checked":a[0]||(a[0]=e=>v.showTable=e),title:"显示图层内所有矢量数据列表"},{default:c((()=>[h("显示列表")])),_:1},8,["checked"])])),_:1})]),v.showTable?(s(),r(B,{key:0,"row-selection":A.value,dataSource:W.value,columns:H.value,bordered:"",pagination:{pageSize:5},size:"small",customRow:N},{bodyCell:c((({column:e,record:a})=>["edit"===e.dataIndex?(s(),r(f,{key:0},{default:c((()=>[d(k,{icon:"aiming",color:"#f2f2f2",class:"icon-vertical-a",title:"飞行定位",onClick:m((e=>(e=>{const a=S.getLayerById(e.key);a&&a.flyTo()})(a)),["stop"])},null,8,["onClick"]),d(k,{icon:"delete",color:"#f2f2f2",class:"icon-vertical-a",title:"删除图层",onClick:m((e=>(e=>{const a=S.getLayerById(e.key);a&&(a.remove(!0),v.layerName="")})(a)),["stop"])},null,8,["onClick"])])),_:2},1024)):u("",!0)])),_:1},8,["row-selection","dataSource","columns"])):u("",!0),v.showTable&&v.layerName?(s(),o("div",x,[n("h2",T,p(v.layerName),1),n("div",w,[n("div",_,[d(f,null,{default:c((()=>[C,d(t,{checked:v.show,"onUpdate:checked":a[1]||(a[1]=e=>v.show=e),onChange:D,title:"显示隐藏状态"},{default:c((()=>[h("显示")])),_:1},8,["checked"])])),_:1})]),n("div",L,[d(U,{options:j})]),g.interaction?(s(),o("div",I,[d(f,null,{default:c((()=>[P,d(t,{checked:v.hasPopup,"onUpdate:checked":a[2]||(a[2]=e=>v.hasPopup=e),onChange:G,title:"是否绑定Popup鼠标单击弹窗"},{default:c((()=>[h("单击Popup")])),_:1},8,["checked"]),d(t,{checked:v.hasHighlight,"onUpdate:checked":a[3]||(a[3]=e=>v.hasHighlight=e),onChange:K,title:"是否绑定单击高亮其对应矢量数据"},{default:c((()=>[h("单击高亮")])),_:1},8,["checked"])])),_:1})])):u("",!0)])])):u("",!0)],64)}}}),[["__scopeId","data-v-00eebe4a"]]);export{W as T};
